<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Infernal Arcade - Destrua os Dem√¥nios!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000000;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            touch-action: none;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        #gameCanvas {
            display: block;
            background: #000000;
            touch-action: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #ui {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ff4400;
            font-size: 18px;
            text-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000;
            z-index: 10;
            pointer-events: none;
        }

        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 40px;
            border: 3px solid #ff4400;
            border-radius: 10px;
            text-align: center;
            display: none;
            z-index: 100;
            box-shadow: 0 0 50px #ff0000;
        }

        #gameOver h1 {
            color: #ff0000;
            font-size: 36px;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #ff0000;
        }

        #gameOver p {
            color: #ff6600;
            font-size: 24px;
            margin: 10px 0;
        }

        #restartBtn {
            background: linear-gradient(to bottom, #ff4400, #cc0000);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 20px;
            margin-top: 20px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            box-shadow: 0 0 20px #ff0000;
            transition: all 0.3s;
        }

        #restartBtn:active {
            transform: scale(0.95);
            box-shadow: 0 0 30px #ff0000;
        }

        #controls {
            position: absolute;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10;
        }

        .control-btn {
            width: 80px;
            height: 80px;
            background: rgba(255, 68, 0, 0.3);
            border: 3px solid #ff4400;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff4400;
            font-size: 24px;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(255, 68, 0, 0.5);
            touch-action: none;
            user-select: none;
        }

        .control-btn:active {
            background: rgba(255, 68, 0, 0.6);
            box-shadow: 0 0 30px rgba(255, 68, 0, 0.8);
        }

        #shootBtn {
            width: 100px;
            height: 100px;
            font-size: 32px;
        }

        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        #startScreen h1 {
            color: #ff0000;
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 0 0 30px #ff0000;
            animation: pulse 2s infinite;
        }

        #startScreen p {
            color: #ff6600;
            font-size: 20px;
            margin: 10px 0;
            max-width: 80%;
            text-align: center;
        }

        #startBtn {
            background: linear-gradient(to bottom, #ff4400, #cc0000);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 24px;
            margin-top: 30px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            box-shadow: 0 0 30px #ff0000;
            animation: glow 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 30px #ff0000; }
            50% { box-shadow: 0 0 50px #ff0000, 0 0 70px #ff4400; }
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <h1>üî• INFERNAL ARCADE üî•</h1>
        <p>Os port√µes do inferno se abriram!</p>
        <p>Destrua os dem√¥nios antes que eles te alcancem!</p>
        <p>Use os bot√µes para mover e atirar</p>
        <button id="startBtn">INICIAR BATALHA</button>
    </div>

    <div id="ui">
        <div>üíÄ VIDAS: <span id="lives">3</span></div>
        <div>üî• PONTOS: <span id="score">0</span></div>
        <div>üëπ N√çVEL: <span id="level">1</span></div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div id="controls">
        <div style="display: flex; gap: 10px;">
            <div class="control-btn" id="leftBtn">‚óÄ</div>
            <div class="control-btn" id="rightBtn">‚ñ∂</div>
        </div>
        <div class="control-btn" id="shootBtn">üî•</div>
    </div>

    <div id="gameOver">
        <h1>GAME OVER</h1>
        <p>Pontua√ß√£o Final: <span id="finalScore">0</span></p>
        <p>N√≠vel Alcan√ßado: <span id="finalLevel">1</span></p>
        <button id="restartBtn">JOGAR NOVAMENTE</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Sistema de Audio
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'shoot':
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                    
                case 'explosion':
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.2);
                    break;
                    
                case 'hit':
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(100, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
                    
                case 'levelup':
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.01, audioContext.currentTime + 0.3);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                    
                case 'gameover':
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.5);
                    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                    break;
            }
        }
        
        // M√∫sica de fundo
        let backgroundMusic = null;
        let musicGain = null;
        
        function startBackgroundMusic() {
            if (backgroundMusic) return;
            
            musicGain = audioContext.createGain();
            musicGain.gain.setValueAtTime(0.1, audioContext.currentTime);
            musicGain.connect(audioContext.destination);
            
            function playNote(freq, duration, delay) {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(freq, audioContext.currentTime + delay);
                gain.gain.setValueAtTime(0, audioContext.currentTime + delay);
                gain.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + delay + 0.01);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + delay + duration);
                
                osc.connect(gain);
                gain.connect(musicGain);
                
                osc.start(audioContext.currentTime + delay);
                osc.stop(audioContext.currentTime + delay + duration);
            }
            
            function musicLoop() {
                if (!gameState.playing || gameState.gameOver) return;
                
                // Sequ√™ncia musical sombria
                const notes = [
                    [220, 0.3, 0],      // A3
                    [196, 0.3, 0.3],    // G3
                    [220, 0.3, 0.6],    // A3
                    [196, 0.3, 0.9],    // G3
                    [165, 0.6, 1.2],    // E3
                    [220, 0.3, 1.8],    // A3
                    [196, 0.3, 2.1],    // G3
                    [175, 0.6, 2.4],    // F3
                ];
                
                notes.forEach(([freq, duration, delay]) => {
                    playNote(freq, duration, delay);
                });
                
                setTimeout(musicLoop, 3000);
            }
            
            musicLoop();
            backgroundMusic = true;
        }
        
        function stopBackgroundMusic() {
            backgroundMusic = null;
        }
        
        // Configurar canvas para mobile
        function resizeCanvas() {
            const maxWidth = window.innerWidth;
            const maxHeight = window.innerHeight - 120; // Espa√ßo para controles
            const aspectRatio = 9 / 16;
            
            if (maxWidth / maxHeight > aspectRatio) {
                canvas.height = maxHeight;
                canvas.width = maxHeight * aspectRatio;
            } else {
                canvas.width = maxWidth;
                canvas.height = maxWidth / aspectRatio;
            }
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Estado do jogo
        let gameState = {
            lives: 3,
            score: 0,
            level: 1,
            gameOver: false,
            playing: false
        };

        // Sistema de cores por n√≠vel
        const colorThemes = {
            1: { primary: '#ff4400', secondary: '#ff0000', name: 'Vermelho Infernal', bg: '#1a0000' },
            2: { primary: '#ff00ff', secondary: '#aa00ff', name: 'Roxo M√≠stico', bg: '#1a001a' },
            3: { primary: '#ffff00', secondary: '#ffaa00', name: 'Amarelo Radiante', bg: '#1a1a00' },
            4: { primary: '#00ff00', secondary: '#00aa00', name: 'Verde T√≥xico', bg: '#001a00' },
            5: { primary: '#00ffff', secondary: '#0088ff', name: 'Azul G√©lido', bg: '#001a1a' },
            6: { primary: '#ff0088', secondary: '#ff0044', name: 'Rosa Demon√≠aco', bg: '#1a0010' },
            7: { primary: '#ff8800', secondary: '#ff4400', name: 'Laranja Flamejante', bg: '#1a0f00' },
            8: { primary: '#8800ff', secondary: '#4400ff', name: 'Violeta Sombrio', bg: '#0f001a' },
            9: { primary: '#00ff88', secondary: '#00aa44', name: 'Verde Neon', bg: '#001a0f' },
            10: { primary: '#ff0000', secondary: '#880000', name: 'Vermelho Sangue', bg: '#1a0000' }
        };

        function getCurrentTheme() {
            const themeIndex = ((gameState.level - 1) % 10) + 1;
            return colorThemes[themeIndex];
        }

        function updateThemeColors() {
            const theme = getCurrentTheme();
            
            // Atualizar UI
            const uiElements = document.querySelectorAll('#ui, #ui div, #ui span');
            uiElements.forEach(el => {
                el.style.color = theme.primary;
                el.style.textShadow = `0 0 10px ${theme.primary}, 0 0 20px ${theme.secondary}`;
            });
            
            // Atualizar controles
            const controls = document.querySelectorAll('.control-btn');
            controls.forEach(btn => {
                btn.style.background = `rgba(${hexToRgb(theme.primary)}, 0.3)`;
                btn.style.borderColor = theme.primary;
                btn.style.color = theme.primary;
                btn.style.boxShadow = `0 0 20px rgba(${hexToRgb(theme.primary)}, 0.5)`;
            });
            
            // Atualizar cor do jogador
            player.color = theme.primary;
            player.secondaryColor = theme.secondary;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? 
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` 
                : '255, 68, 0';
        }

        // Jogador
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 80,
            width: 40,
            height: 40,
            speed: 5,
            color: '#ff4400',
            secondaryColor: '#ff0000'
        };

        // Arrays
        let bullets = [];
        let enemies = [];
        let particles = [];
        let powerups = [];

        // Controles
        let keys = {
            left: false,
            right: false,
            shoot: false
        };

        let shootCooldown = 0;

        // Eventos de toque
        document.getElementById('leftBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.left = true;
        });
        
        document.getElementById('leftBtn').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.left = false;
        });

        document.getElementById('rightBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.right = true;
        });
        
        document.getElementById('rightBtn').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.right = false;
        });

        document.getElementById('shootBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.shoot = true;
        });
        
        document.getElementById('shootBtn').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.shoot = false;
        });

        // Teclado para desktop
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') keys.left = true;
            if (e.key === 'ArrowRight') keys.right = true;
            if (e.key === ' ') keys.shoot = true;
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft') keys.left = false;
            if (e.key === 'ArrowRight') keys.right = false;
            if (e.key === ' ') keys.shoot = false;
        });

        // Classes
        class Bullet {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 4;
                this.height = 15;
                this.speed = 8;
                const theme = getCurrentTheme();
                this.color = theme.primary;
            }

            update() {
                this.y -= this.speed;
            }

            draw() {
                ctx.shadowBlur = 15;
                ctx.shadowColor = this.color;
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x - this.width / 2, this.y, this.width, this.height);
                ctx.shadowBlur = 0;
            }
        }

        class Enemy {
            constructor(x, y, type = 'normal') {
                this.x = x;
                this.y = y;
                this.width = 35;
                this.height = 35;
                this.speed = 1 + gameState.level * 0.2;
                this.type = type;
                this.health = type === 'boss' ? 5 : 1;
                const theme = getCurrentTheme();
                // Inimigos usam a cor secund√°ria do tema
                this.color = type === 'boss' ? theme.secondary : theme.primary;
                this.movePattern = Math.random() * Math.PI * 2;
            }

            update() {
                this.y += this.speed;
                this.movePattern += 0.05;
                this.x += Math.sin(this.movePattern) * 2;
            }

            draw() {
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                
                // Desenhar dem√¥nio
                ctx.fillStyle = this.color;
                ctx.beginPath();
                // Corpo
                ctx.arc(this.x, this.y, this.width / 2, 0, Math.PI * 2);
                ctx.fill();
                
                // Chifres
                ctx.fillStyle = this.type === 'boss' ? '#000000' : this.color;
                ctx.globalAlpha = 0.7;
                ctx.beginPath();
                ctx.moveTo(this.x - 15, this.y - 15);
                ctx.lineTo(this.x - 10, this.y - 25);
                ctx.lineTo(this.x - 5, this.y - 15);
                ctx.fill();
                
                ctx.beginPath();
                ctx.moveTo(this.x + 15, this.y - 15);
                ctx.lineTo(this.x + 10, this.y - 25);
                ctx.lineTo(this.x + 5, this.y - 15);
                ctx.fill();
                ctx.globalAlpha = 1;
                
                // Olhos
                ctx.fillStyle = '#000000';
                ctx.fillRect(this.x - 8, this.y - 5, 5, 8);
                ctx.fillRect(this.x + 3, this.y - 5, 5, 8);
                
                ctx.shadowBlur = 0;

                // Barra de vida para boss
                if (this.type === 'boss') {
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(this.x - 20, this.y - 30, 40, 5);
                    ctx.fillStyle = this.color;
                    ctx.fillRect(this.x - 20, this.y - 30, 40 * (this.health / 5), 5);
                }
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 8;
                this.vy = (Math.random() - 0.5) * 8;
                this.size = Math.random() * 4 + 2;
                this.color = color;
                this.life = 30;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.3;
                this.life--;
                this.size *= 0.95;
            }

            draw() {
                ctx.globalAlpha = this.life / 30;
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.size, this.size);
                ctx.globalAlpha = 1;
                ctx.shadowBlur = 0;
            }
        }

        function createExplosion(x, y, color) {
            for (let i = 0; i < 15; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function spawnEnemies() {
            if (Math.random() < 0.02 + gameState.level * 0.005) {
                const x = Math.random() * (canvas.width - 40) + 20;
                const isBoss = Math.random() < 0.05;
                enemies.push(new Enemy(x, -30, isBoss ? 'boss' : 'normal'));
            }
        }

        function checkCollisions() {
            // Balas vs Inimigos
            bullets.forEach((bullet, bIndex) => {
                enemies.forEach((enemy, eIndex) => {
                    if (bullet.x > enemy.x - enemy.width / 2 &&
                        bullet.x < enemy.x + enemy.width / 2 &&
                        bullet.y > enemy.y - enemy.height / 2 &&
                        bullet.y < enemy.y + enemy.height / 2) {
                        
                        enemy.health--;
                        bullets.splice(bIndex, 1);
                        
                        if (enemy.health <= 0) {
                            createExplosion(enemy.x, enemy.y, enemy.color);
                            playSound('explosion');
                            gameState.score += enemy.type === 'boss' ? 50 : 10;
                            enemies.splice(eIndex, 1);
                            
                            if (gameState.score % 200 === 0) {
                                gameState.level++;
                                playSound('levelup');
                                updateThemeColors();
                                document.getElementById('level').textContent = gameState.level;
                            }
                        } else {
                            playSound('hit');
                        }
                    }
                });
            });

            // Inimigos vs Jogador
            enemies.forEach((enemy, index) => {
                if (Math.abs(enemy.x - player.x) < (enemy.width + player.width) / 2 &&
                    Math.abs(enemy.y - player.y) < (enemy.height + player.height) / 2) {
                    
                    createExplosion(enemy.x, enemy.y, enemy.color);
                    playSound('hit');
                    enemies.splice(index, 1);
                    gameState.lives--;
                    document.getElementById('lives').textContent = gameState.lives;
                    
                    if (gameState.lives <= 0) {
                        endGame();
                    }
                }

                if (enemy.y > canvas.height) {
                    enemies.splice(index, 1);
                    playSound('hit');
                    gameState.lives--;
                    document.getElementById('lives').textContent = gameState.lives;
                    
                    if (gameState.lives <= 0) {
                        endGame();
                    }
                }
            });
        }

        function update() {
            if (!gameState.playing || gameState.gameOver) return;

            // Mover jogador
            if (keys.left && player.x > player.width / 2) {
                player.x -= player.speed;
            }
            if (keys.right && player.x < canvas.width - player.width / 2) {
                player.x += player.speed;
            }

            // Atirar
            if (keys.shoot && shootCooldown <= 0) {
                bullets.push(new Bullet(player.x, player.y - 20));
                playSound('shoot');
                shootCooldown = 10;
            }
            if (shootCooldown > 0) shootCooldown--;

            // Atualizar balas
            bullets.forEach((bullet, index) => {
                bullet.update();
                if (bullet.y < 0) bullets.splice(index, 1);
            });

            // Atualizar inimigos
            enemies.forEach(enemy => enemy.update());

            // Atualizar part√≠culas
            particles.forEach((particle, index) => {
                particle.update();
                if (particle.life <= 0) particles.splice(index, 1);
            });

            spawnEnemies();
            checkCollisions();

            document.getElementById('score').textContent = gameState.score;
        }

        function drawPlayer() {
            ctx.shadowBlur = 15;
            ctx.shadowColor = player.color;
            ctx.fillStyle = player.color;
            
            // Nave
            ctx.beginPath();
            ctx.moveTo(player.x, player.y - 20);
            ctx.lineTo(player.x - 20, player.y + 20);
            ctx.lineTo(player.x, player.y + 10);
            ctx.lineTo(player.x + 20, player.y + 20);
            ctx.closePath();
            ctx.fill();
            
            // Motor
            ctx.fillStyle = player.secondaryColor;
            ctx.fillRect(player.x - 5, player.y + 15, 10, 10);
            
            ctx.shadowBlur = 0;
        }

        function drawBackground() {
            const theme = getCurrentTheme();
            
            // Fundo com gradiente sutil do tema
            const gradient = ctx.createRadialGradient(
                canvas.width / 2, canvas.height / 2, 0,
                canvas.width / 2, canvas.height / 2, canvas.width
            );
            gradient.addColorStop(0, theme.bg);
            gradient.addColorStop(1, '#000000');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Estrelas em movimento com cor do tema
            ctx.fillStyle = theme.primary;
            ctx.shadowBlur = 3;
            ctx.shadowColor = theme.primary;
            for (let i = 0; i < 50; i++) {
                const x = (i * 37) % canvas.width;
                const y = ((Date.now() * 0.05 + i * 53) % canvas.height);
                ctx.globalAlpha = 0.3 + (Math.sin(Date.now() * 0.001 + i) * 0.3);
                ctx.fillRect(x, y, 2, 2);
            }
            ctx.globalAlpha = 1;
            ctx.shadowBlur = 0;
        }

        function draw() {
            // Limpar com preto s√≥lido
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            drawBackground();
            
            bullets.forEach(bullet => bullet.draw());
            enemies.forEach(enemy => enemy.draw());
            particles.forEach(particle => particle.draw());
            
            if (gameState.playing && !gameState.gameOver) {
                drawPlayer();
            }
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            gameState.playing = true;
            gameState.gameOver = false;
            gameState.lives = 3;
            gameState.score = 0;
            gameState.level = 1;
            bullets = [];
            enemies = [];
            particles = [];
            player.x = canvas.width / 2;
            
            document.getElementById('lives').textContent = gameState.lives;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('gameOver').style.display = 'none';
            
            // Aplicar cores do tema inicial
            updateThemeColors();
            
            // Iniciar m√∫sica de fundo
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
            startBackgroundMusic();
        }

        function endGame() {
            gameState.gameOver = true;
            playSound('gameover');
            stopBackgroundMusic();
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('finalLevel').textContent = gameState.level;
            document.getElementById('gameOver').style.display = 'block';
        }

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('restartBtn').addEventListener('click', startGame);

        gameLoop();
    </script>
</body>
</html>
